#tag ClassProtected Class FGScopeBarItem	#tag Method, Flags = &h0		Sub Constructor(Title as String, Tag as Variant = "", Icon as Picture = nil)		  me.Title = Title		  me.Tag = Tag		  me.Icon = Icon		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function Image(Hover as Boolean, drawGradientBackground as Boolean) As Picture		  // Internal use only.		  		  #pragma DisableBackgroundTasks		  		  // Returns this item as a Picture.		  // If Hover = True then this item is being hovered over.		  		  dim p as Picture		  dim backgroundWidth, titleWidth, edgeWidth as integer		  dim titleColour as Color		  		  p = new Picture(me.Width, kItemHeight, 32)		  p.Transparent = Picture.TransparentWhite		  		  dim g as Graphics = p.Graphics		  		  edgeWidth = fg_sb_item_left_edge_pressed.Width		  		  if me.Selected then		    		    titleColour = kColourTitleSelected		    		    g.DrawPicture(fg_sb_item_left_edge_pressed, 0, 0) ' left edge		    		    backgroundWidth = g.Width - (edgeWidth * 2)		    g.DrawPicture(fg_sb_item_background_pressed, edgeWidth, 0, backgroundWidth, g.Height, _		    0, 0, fg_sb_item_background_pressed.Width, fg_sb_item_background_pressed.Height) ' fill		    		    g.DrawPicture(fg_sb_item_right_edge_pressed, g.Width - fg_sb_item_right_edge_pressed.Width, 0) ' right edge		    		  elseif Hover or mIntermediateState then		    		    titleColour = kColourTitleSelected		    		    g.DrawPicture(fg_sb_item_left_edge_hover, 0, 0) ' left edge		    		    backgroundWidth = g.Width - (edgeWidth * 2)		    g.DrawPicture(fg_sb_item_background_hover, edgeWidth, 0, backgroundWidth, g.Height, _		    0, 0, fg_sb_item_background_hover.Width, fg_sb_item_background_hover.Height) ' fill		    		    g.DrawPicture(fg_sb_item_right_edge_hover, g.Width - fg_sb_item_right_edge_hover.Width, 0) ' right edge		    		  else		    		    titleColour = kColourTitle		    		    // Fill		    if drawGradientBackground then		      g.DrawPicture(fg_sb_background, 0, 0, g.Width, g.Height, 0, 0, fg_sb_background.Width, fg_sb_background.Height)		    else		      // not necessary here, TT believes		      'g.DrawPicture(window_bg, 0, 0, g.Width, g.Height, 0, 0, window_bg.Width, window_bg.Height)		    end		    		  end if		  		  // Icon		  if Icon <> nil then g.DrawPicture(Icon, edgeWidth, (g.Height/2)-(icon.Height/2))		  		  // Title		  g.TextSize = 12		  g.Bold = true		  g.ForeColor = titleColour		  titleWidth = g.StringWidth(Title)		  		  if Icon <> nil then		    g.DrawString(Title, Icon.Width + kPadding, kTitleBaseline)		  else		    g.DrawString(Title, (p.Width/2)-(titleWidth/2), kTitleBaseline)		  end if		  		  // Return the image		  return p		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function PopupWidth() As Integer		  // Internal use only.		  		  #pragma DisableBackgroundTasks		  		  // This method returns the width of this item when it's in a popup		  // Considers the width of the text, the icon (if present) and the item surrounding.		  		  if Title = "" then return 0 ' must have a title		  		  dim w as integer		  dim p as new picture(5,5,32) ' dummy picture just to get a graphics object...		  		  // Set graphics parameters		  p.Graphics.TextSize = 12		  p.Graphics.Bold = true		  		  // Button edges		  w = w + fg_sb_item_left_edge_pressed.Width + fg_sb_popup_right.Width		  		  // Icon		  if icon <> nil then w = icon.Width + kPadding		  		  // Title		  w = w + p.Graphics.StringWidth(Title)		  		  return w		  		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function Width() As Integer		  // Internal use only.		  		  #pragma DisableBackgroundTasks		  		  // This method returns the width of this item.		  // Considers the width of the text, the icon (if present) and the item surrounding.		  		  if Title = "" then return 0 ' must have a title		  		  dim w as integer		  dim p as new picture(5,5,32) ' dummy picture just to get a graphics object...		  		  // Set graphics parameters		  p.Graphics.TextSize = 12		  p.Graphics.Bold = true		  		  // Button edges		  w = w + fg_sb_item_left_edge_pressed.Width + fg_sb_item_right_edge_pressed.Width		  		  // Icon		  if icon <> nil then w = icon.Width + (2 * kPadding)		  		  // Title		  w = w + p.Graphics.StringWidth(Title)		  		  return w		  		End Function	#tag EndMethod	#tag Property, Flags = &h0		Icon As Picture	#tag EndProperty	#tag ComputedProperty, Flags = &h0		#tag Getter			Get			  return mIntermediateState			End Get		#tag EndGetter		#tag Setter			Set			  mIntermediateState = value			  mSelected = false			End Set		#tag EndSetter		IntermediateState As Boolean	#tag EndComputedProperty	#tag Property, Flags = &h21		Private mIntermediateState As Boolean	#tag EndProperty	#tag Property, Flags = &h21		Private mSelected As Boolean = False	#tag EndProperty	#tag ComputedProperty, Flags = &h0		#tag Getter			Get			  return mSelected			End Get		#tag EndGetter		#tag Setter			Set			  mSelected = value			  mIntermediateState = false			End Set		#tag EndSetter		Selected As Boolean	#tag EndComputedProperty	#tag Property, Flags = &h0		Tag As Variant	#tag EndProperty	#tag Property, Flags = &h0		Title As String	#tag EndProperty	#tag Constant, Name = kColourTitle, Type = Color, Dynamic = False, Default = \"&c333333", Scope = Private	#tag EndConstant	#tag Constant, Name = kColourTitleSelected, Type = Color, Dynamic = False, Default = \"&cFDFDFD", Scope = Private	#tag EndConstant	#tag Constant, Name = kItemHeight, Type = Double, Dynamic = False, Default = \"20", Scope = Private	#tag EndConstant	#tag Constant, Name = kPadding, Type = Double, Dynamic = False, Default = \"12", Scope = Private	#tag EndConstant	#tag Constant, Name = kTitleBaseline, Type = Double, Dynamic = False, Default = \"14", Scope = Private	#tag EndConstant	#tag Constant, Name = Version, Type = String, Dynamic = False, Default = \"1.0", Scope = Public	#tag EndConstant	#tag ViewBehavior		#tag ViewProperty			Name="Icon"			Group="Behavior"			Type="Picture"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			Type="Integer"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="IntermediateState"			Group="Behavior"			Type="Boolean"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			Type="Integer"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			Type="String"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Selected"			Group="Behavior"			InitialValue="False"			Type="Boolean"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			Type="String"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Title"			Group="Behavior"			Type="String"			EditorType="MultiLineEditor"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			Type="Integer"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass